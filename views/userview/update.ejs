<!DOCTYPE html>
<html>
<head>
  <title>Update User Details</title>
</head>
<body>
<%- include('../partials/header') %>
<section class="sectionmin">
  <h1 class="mainheading">Update User Details (<%= id %>) </h1>
  <p class="maintext">
    Please update the details below and submit to save changes.
  </p>

  <form class="formpart" action="/users/update/<%= id %>" method="post">
    <h4 class="backtolist">
      <a href="/users/<%= querydata %>">Back to List</a>
    </h4>
    <% if (error) { %>
      <aside class="errormessage"><%= error %></aside>
    <% } %>
    <% if (success) { %>
      <aside class="successmessage"><%= success %></aside>
      <script>
        setTimeout(() => {
          window.location.href = "/users/<%= querydata %>";
        }, 2000); 
      </script>
    <% } %>
    
    <input type="hidden" name="querydata" value="<%= querydata %>">
    <div>
        <label>Fullname:</label>
        <input 
            type="text" 
            name="fullname" 
             value="<%= result.fullname || '' %>"
        />
    </div>
    <div>
        <label>Mobile:</label>
        <input 
            type="text" 
            name="mobile" 
            value="<%= result.mobile || '' %>"
            maxlength="10"
        />
    </div>
    <div>
        <label>Email:</label>
        <input 
            type="text" 
            name="email" 
            value="<%= result.email || '' %>"
        />
    </div>
    <div> 
        <label>Role:</label>
        <select name="role">
          <option value="" disabled <%= !result.role ? 'selected' : '' %>>Select</option>
          <option value="user" <%= result.role === 'user' ? 'selected' : '' %>>User</option>
          <option value="admin" <%= result.role === 'admin' ? 'selected' : '' %>>Admin</option>
          <option value="superadmin" <%= result.role === 'superadmin' ? 'selected' : '' %>>Superadmin</option>
        </select>
    </div>
    <div>
      <button type="submit">Update</button>
    </div>
  </form>
</section>
<%- include('../partials/footer', { title: 'EMP Management System' }) %>
</body>
</html>
